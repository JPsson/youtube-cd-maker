/* ========== base theme ========== */
:root {
  --bg: #f6f6f8;
  --panel: #ffffff;
  --panel-muted: #fbfbfc;
  --panel-subtle: #f0f0f5;
  --panel-hover: #f6f6fa;
  --panel-pad: clamp(20px, 4vw, 24px);
  --border: #e0e1e6;
  --border-strong: #d4d4dd;
  --border-subtle: #e4e4ec;
  --text: #111216;
  --muted: #767680;
  --accent: #111111;
  --accent-contrast: #ffffff;
  --accent-active: #0a0a0a;
  --focus-ring: rgba(17, 17, 17, 0.08);
  --shadow-panel: 0 18px 32px rgba(17, 18, 22, 0.06);
  --shadow-thumb: 0 14px 28px rgba(17, 18, 22, 0.08);
  --shadow-overlay: 0 30px 60px rgba(17, 18, 22, 0.12);
  --shadow-overlay-disc: 0 12px 28px rgba(17, 18, 22, 0.2);
  --overlay-scrim: rgba(246, 246, 248, 0.96);
  --overlay-card: #ffffff;
  --overlay-thumb: #f2f2f7;
  --modal-scrim: rgba(17, 18, 22, 0.55);
  --modal-card: #ffffff;
  --modal-shadow: 0 30px 60px rgba(17, 18, 22, 0.12);
  --disc-gradient: radial-gradient(circle at 32% 28%, #ffffff 0%, #f3f3f8 45%, #e8e8ef 70%, #dedee6 100%);
  --disc-border: #d2d2dc;
  --disc-inner-border: rgba(209, 209, 222, 0.8);
  --disc-inner-gradient: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, rgba(223, 223, 232, 0.65) 100%);
  --disc-halo-inner: rgba(255, 255, 255, 0.4);
  --disc-halo-outer: rgba(17, 18, 22, 0.06);
  --disc-image-shadow: 0 12px 28px rgba(17, 18, 22, 0.2);
  --disabled-bg: #f0f0f5;
  --disabled-text: #b2b2bd;
  --disabled-border: #e4e4ec;
  --danger: #d5484a;
  --action-danger-border: rgba(213, 72, 74, 0.4);
  --gauge-track: #f0f0f5;
  --table-hover-bg: #f6f6fa;
  --skeleton-base: #f0f0f5;
  --fmt-bg: #f3f3f8;
  --fmt-border: #e0e1e6;
  --toggle-border: rgba(17, 18, 22, 0.08);
  --toggle-bg: rgba(255, 255, 255, 0.7);
  --toggle-icon-light: #f8f8fb;
  --toggle-icon-dark: #111216;
  --toggle-icon-ring: rgba(17, 18, 22, 0.45);
  --link-muted: rgba(17, 18, 22, 0.55);
}

:root[data-theme="dark"] {
  --bg: #0f0f10;
  --panel: #161618;
  --panel-muted: #1d1d20;
  --panel-subtle: #1a1a1e;
  --panel-hover: rgba(255, 255, 255, 0.05);
  --panel-pad: clamp(20px, 4vw, 24px);
  --border: #2a2a2e;
  --border-strong: #343439;
  --border-subtle: #2f2f34;
  --text: #e7e7ea;
  --muted: #9a9aa3;
  --accent: #ffffff;
  --accent-contrast: #000000;
  --accent-active: #d0d0d6;
  --focus-ring: rgba(255, 255, 255, 0.12);
  --shadow-panel: 0 26px 48px rgba(0, 0, 0, 0.45);
  --shadow-thumb: 0 24px 44px rgba(0, 0, 0, 0.5);
  --shadow-overlay: 0 32px 60px rgba(0, 0, 0, 0.58);
  --shadow-overlay-disc: 0 16px 32px rgba(0, 0, 0, 0.55);
  --overlay-scrim: rgba(12, 12, 14, 0.84);
  --overlay-card: #1c1c20;
  --overlay-thumb: #222227;
  --modal-scrim: rgba(10, 10, 12, 0.7);
  --modal-card: #1c1c20;
  --modal-shadow: 0 32px 60px rgba(0, 0, 0, 0.55);
  --disc-gradient: radial-gradient(circle at 32% 28%, #2a2a31 0%, #222229 45%, #1a1a20 70%, #121216 100%);
  --disc-border: #2f2f36;
  --disc-inner-border: rgba(80, 80, 92, 0.7);
  --disc-inner-gradient: radial-gradient(circle, rgba(48, 48, 60, 0.4) 0%, rgba(16, 16, 24, 0.85) 100%);
  --disc-halo-inner: rgba(255, 255, 255, 0.16);
  --disc-halo-outer: rgba(0, 0, 0, 0.5);
  --disc-image-shadow: 0 12px 28px rgba(0, 0, 0, 0.5);
  --disabled-bg: #1a1a1e;
  --disabled-text: #51515c;
  --disabled-border: #27272c;
  --action-danger-border: rgba(213, 72, 74, 0.5);
  --gauge-track: #1b1b1f;
  --table-hover-bg: rgba(255, 255, 255, 0.05);
  --skeleton-base: #232327;
  --fmt-bg: #1b1b20;
  --fmt-border: #2a2a30;
  --toggle-border: rgba(255, 255, 255, 0.2);
  --toggle-bg: rgba(18, 18, 22, 0.7);
  --toggle-icon-light: #e7e7ea;
  --toggle-icon-dark: #09090b;
  --toggle-icon-ring: rgba(231, 231, 234, 0.6);
  --link-muted: rgba(231, 231, 234, 0.65);
}

/* ========== resets ========== */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font: 16px/1.5 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  min-height: 100vh;
  min-height: 100svh;
  display: grid;
  grid-template-rows: minmax(24px, 1fr) auto minmax(24px, 1fr);
  transition: background-color 200ms ease, color 200ms ease;
}

.no-theme-transition *,
.no-theme-transition *::before,
.no-theme-transition *::after {
  transition: none !important;
  animation: none !important;
}

/* ========== layout ========== */
.wrap {
  grid-row: 2;
  width: min(660px, 100%);
  margin: clamp(16px, 4vw, 32px) auto;
  padding: 0 clamp(16px, 4vw, 32px);
  padding-bottom: clamp(72px, 10vh, 128px);
  display: flex;
  flex-direction: column;
  align-items: stretch;
  position: relative;
}

.stack > * + * {
  margin-top: 6px;
}

h1 {
  margin: 0;
  text-align: center;
  font-weight: 700;
  letter-spacing: 0.3px;
  font-size: 28px;
}

.brandMark {
  display: block;
  width: clamp(200px, 60vw, 420px);
  height: auto;
  margin: 0 auto 12px;
  border: 0;
  box-shadow: none;
  border-radius: 0;
}

.subtle {
  color: var(--muted);
}

.panel {
  background: var(--panel);
  border: 1px solid var(--border);
  padding: var(--panel-pad);
  border-radius: 12px;
  box-shadow: var(--shadow-panel);
  margin-top: 16px;
  transition: background-color 200ms ease, border-color 200ms ease, color 200ms ease,
    box-shadow 200ms ease;
}

.row {
  display: flex;
  gap: 10px;
  align-items: center;
}

.row.end {
  justify-content: flex-end;
}

.row.actions {
  display: grid;
  justify-content: center;
  justify-items: center;
  align-items: center;
  gap: 14px;
  margin-top: 16px;
  grid-auto-columns: max-content;
  grid-template-areas: "add or mp3 wav";
}

.row.actions #btnAdd {
  grid-area: add;
}

.row.actions #btnMp3 {
  grid-area: mp3;
}

.row.actions #btnWav {
  grid-area: wav;
}

.row.actions .or {
  grid-area: or;
}

.row.actions .btn {
  min-width: 0;
  padding-inline: 16px;
}

.row.actions #btnAdd {
  padding-inline: 18px;
}

.row.actions #btnMp3,
.row.actions #btnWav {
  padding-inline: 12px;
  min-width: 84px;
}

.or {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0 6px;
  color: var(--muted);
  font-weight: 600;
  letter-spacing: 0.02em;
  user-select: none;
}

/* ========== form controls & buttons ========== */
.input,
.select {
  flex: 1;
  background: var(--panel-muted);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 12px 14px;
  border-radius: 10px;
  outline: none;
  transition: border-color 160ms ease, box-shadow 160ms ease, background-color 160ms ease,
    color 160ms ease;
}

.input:focus-visible,
.select:focus-visible {
  border-color: var(--accent);
  background: var(--panel);
  box-shadow: 0 0 0 4px var(--focus-ring);
}

.select {
  flex: 0 0 220px;
}

#url {
  display: block;
  width: min(720px, 100%);
  margin: 0 auto;
}

#url.input {
  flex: 0 1 auto;
}

.btn {
  background: var(--panel);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 12px 20px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  letter-spacing: 0.01em;
  transition: background-color 160ms ease, color 160ms ease, border-color 160ms ease,
    opacity 120ms ease;
  min-width: 110px;
  text-align: center;
}

.btn:hover:not(:disabled),
.btn:focus-visible:not(:disabled) {
  background: var(--accent);
  color: var(--accent-contrast);
  border-color: var(--accent);
}

.btn:disabled {
  background: var(--disabled-bg);
  color: var(--disabled-text);
  border-color: var(--disabled-border);
  cursor: not-allowed;
  opacity: 1;
}

.btn.ghost:disabled {
  background: var(--disabled-bg);
  color: var(--disabled-text);
  border-color: var(--disabled-border);
}

.btn.ghost {
  background: transparent;
  color: var(--text);
}

.btn.ghost.alt {
  background: var(--panel-subtle);
  border-color: var(--border-strong);
}

.btn.ghost.alt:disabled {
  background: var(--panel-subtle);
  color: var(--disabled-text);
  border-color: var(--disabled-border);
}

.action:disabled {
  background: var(--disabled-bg);
  color: var(--disabled-text);
  border-color: var(--disabled-border);
  cursor: not-allowed;
}

.disclaimerLink {
  padding: 0;
  border: none;
  background: none;
  color: var(--link-muted);
  font: inherit;
  text-decoration: none;
  text-transform: lowercase;
  cursor: pointer;
  letter-spacing: 0.02em;
  transition: color 160ms ease;
  position: fixed;
  bottom: clamp(16px, 5vh, 36px);
  right: clamp(16px, 6vw, 32px);
  margin: 0;
  z-index: 30;
}

.disclaimerLink:hover,
.disclaimerLink:focus-visible {
  color: var(--text);
}

/* ========== theme toggle ========== */
.themeToggle {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  border: 1px solid var(--toggle-border);
  background: var(--toggle-bg);
  display: grid;
  place-items: center;
  padding: 0;
  cursor: pointer;
  transition: background-color 200ms ease, border-color 200ms ease, transform 160ms ease;
  backdrop-filter: blur(8px);
  align-self: flex-start;
  margin: 0 0 16px 0;
}

.themeToggle:hover,
.themeToggle:focus-visible {
  transform: translateY(-1px);
  background: var(--panel);
  border-color: var(--border);
}

.themeToggle__icon {
  width: 22px;
  height: 22px;
}

.themeToggle__half {
  transition: fill 200ms ease;
}

.themeToggle__half--light {
  fill: var(--toggle-icon-light);
}

.themeToggle__half--dark {
  fill: var(--toggle-icon-dark);
}

.themeToggle__ring {
  stroke: var(--toggle-icon-ring);
  stroke-width: 1.4;
}

/* ========== small text & code ========== */
.hint,
.note {
  margin-top: 8px;
  font-size: 12px;
  color: var(--muted);
}

code {
  font: 12px ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  background: var(--fmt-bg);
  color: var(--text);
  padding: 2px 6px;
  border-radius: 6px;
  border: 1px solid var(--fmt-border);
}

/* ========== gauge ========== */
.gauge {
  display: grid;
  gap: 8px;
  margin-bottom: 12px;
}

.gauge__bar {
  height: 14px;
  background: var(--gauge-track);
  border-radius: 999px;
  border: 1px solid var(--border);
  overflow: hidden;
}

.gauge__bar > span {
  display: block;
  height: 100%;
  width: 0%;
  background: var(--accent);
  transition: width 180ms ease;
}

.gauge__label {
  font-size: 13px;
  color: var(--muted);
}

/* ========== table/list ========== */
.tableScroll {
  width: 100%;
  overflow-x: auto;
  padding-bottom: 6px;
}

.list {
  width: 100%;
  border-collapse: collapse;
  min-width: min(520px, 100%);
}

.list thead th {
  text-align: left;
  font-size: 12px;
  font-weight: 600;
  color: var(--muted);
  padding: 8px;
  border-bottom: 1px solid var(--border);
  background: var(--panel);
}

.list tbody td {
  padding: 10px 8px;
  border-bottom: 1px solid var(--border);
  vertical-align: middle;
}

.list tbody tr {
  transition: background-color 160ms ease;
}

.list tbody tr[data-draggable="true"] {
  cursor: grab;
}

.list tbody tr.dragging {
  cursor: grabbing;
  opacity: 0.6;
}

.list tbody tr.dragging .action {
  pointer-events: none;
}

.list tbody tr:hover {
  background: var(--panel-hover);
}

.colIndex {
  width: 54px;
  text-align: right;
  padding-right: 4px;
}

.colTitle {
  width: 100%;
}

.colDur {
  width: 90px;
  white-space: nowrap;
  text-align: left;
}

.colAct {
  width: 200px;
  text-align: left;
}

.colAct--optimistic {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  justify-content: center;
  gap: 8px;
}

.colAct--optimistic .optimisticProgress {
  flex: none;
}

.optimisticProgress {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 28px;
  min-height: 28px;
  color: var(--muted);
}

.optimisticSpinner {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid currentColor;
  border-left-color: transparent;
  display: inline-block;
  animation: optimisticSpinnerTurn 1.6s linear infinite;
  opacity: 0.85;
}

@keyframes optimisticSpinnerTurn {
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: reduce) {
  .optimisticSpinner {
    animation-duration: 2.8s;
  }
}

.srOnly {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.action {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: var(--panel);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 160ms ease, color 160ms ease, border-color 160ms ease,
    transform 160ms ease;
}

.action:hover,
.action:focus-visible {
  background: var(--accent);
  color: var(--accent-contrast);
  border-color: var(--accent);
}

.action:active {
  background: var(--accent-active);
  border-color: var(--accent-active);
}

.action.danger {
  border-color: var(--action-danger-border);
  color: var(--danger);
}

/* ========== thumbnail (between input and buttons) ========== */
.thumbWrap {
  display: none;
  margin: 16px auto 12px;
  width: clamp(240px, 90vw, 520px);
}

.thumbWrap.show {
  display: block;
}

.thumb {
  display: block;
  width: 100%;
  aspect-ratio: 16 / 9;
  object-fit: cover;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--panel-subtle);
  box-shadow: var(--shadow-thumb);
}

.skeleton {
  animation: pulse 1.2s ease-in-out infinite;
  background: var(--skeleton-base);
}

@keyframes pulse {
  0% {
    opacity: 0.45;
  }
  50% {
    opacity: 0.8;
  }
  100% {
    opacity: 0.45;
  }
}

/* ========== overlay (one-off MP3/WAV) ========== */
.overlay {
  position: fixed;
  inset: 0;
  background: var(--overlay-scrim);
  display: grid;
  place-items: center;
  z-index: 9999;
  backdrop-filter: blur(12px);
}

.overlay[hidden] {
  display: none;
}

.overlayCard {
  background: var(--overlay-card);
  border: 1px solid var(--border);
  padding: clamp(28px, 5vw, 36px);
  border-radius: 14px;
  display: grid;
  gap: 18px;
  width: min(420px, calc(100vw - 48px));
  justify-items: center;
  box-shadow: var(--shadow-overlay);
  transition: background-color 200ms ease, border-color 200ms ease, color 200ms ease,
    box-shadow 200ms ease;
}

.overlayVisual {
  display: grid;
  place-items: center;
  width: 100%;
}

.overlayThumbFrame {
  position: relative;
  width: 180px;
  height: 180px;
  border-radius: 18px;
  border: 1px solid var(--border);
  overflow: hidden;
  background: var(--overlay-thumb);
  display: none;
  box-shadow: var(--shadow-thumb);
}

.overlayThumbFrame.show {
  display: block;
}

.overlayThumb {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: inherit;
  display: none;
}

.overlayThumb.show {
  display: block;
}

.overlayText {
  display: grid;
  gap: 6px;
  text-align: center;
}

.overlayTitle {
  font-weight: 600;
  font-size: 18px;
  display: inline-flex;
  align-items: baseline;
  gap: 4px;
}

.overlaySubtitle {
  font-size: 13px;
  line-height: 1.4;
  color: var(--muted);
}

.overlayDisc {
  position: relative;
  width: clamp(200px, 42vw, 260px);
  aspect-ratio: 1 / 1;
  border-radius: 50%;
  background: var(--disc-gradient);
  border: 1px solid var(--disc-border);
  display: none;
  overflow: hidden;
  box-shadow: inset 0 0 0 6px var(--disc-halo-inner),
    inset 0 0 0 18px var(--disc-halo-outer), var(--shadow-overlay-disc);
}

.overlayDisc::after {
  content: "";
  position: absolute;
  inset: 35%;
  border-radius: 50%;
  border: 1px solid var(--disc-inner-border);
  background: var(--disc-inner-gradient);
  pointer-events: none;
}

.overlayDisc.show {
  display: block;
}

.overlayDisc img {
  position: absolute;
  top: 50%;
  left: 50%;
  transform-origin: center;
  border-radius: 12px;
  box-shadow: var(--disc-image-shadow);
  object-fit: cover;
  border: 1px solid rgba(255, 255, 255, 0.7);
}

.overlayDisc img:nth-child(odd) {
  filter: saturate(1.15);
}

.overlayDisc img:nth-child(even) {
  filter: contrast(1.1);
}

/* ========== info overlay (disclaimer) ========== */
.infoOverlay {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  background: var(--modal-scrim);
  z-index: 9998;
  padding: 24px;
  backdrop-filter: blur(4px);
}

.infoOverlay[hidden] {
  display: none;
}

.infoOverlay__card {
  background: var(--modal-card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: clamp(24px, 4vw, 36px);
  width: min(520px, calc(100vw - 48px));
  display: grid;
  gap: 16px;
  box-shadow: var(--modal-shadow);
}

.infoOverlay__card h2 {
  margin: 0;
  font-size: clamp(20px, 2.6vw, 24px);
  letter-spacing: 0.02em;
}

.infoOverlay__card p {
  margin: 0;
  font-size: 14px;
  line-height: 1.6;
  color: var(--muted);
}

.infoOverlay__card p + p {
  margin-top: 6px;
}

.infoOverlay__card .btn {
  justify-self: end;
  min-width: 120px;
}

/* ========== list footer actions ========== */
.listActions {
  margin-top: 16px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
}

.listActions .btn {
  min-width: 160px;
}

/* ========== misc ========== */
.btn,
.action {
  user-select: none;
}

.fmt-debug details {
  margin-top: 8px;
}

.fmt-debug summary {
  cursor: pointer;
  color: var(--muted);
}

.fmt-pre {
  margin-top: 8px;
  white-space: pre-wrap;
  font: 12px ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  background: var(--fmt-bg);
  color: var(--text);
  border: 1px solid var(--fmt-border);
  border-radius: 8px;
  padding: 8px;
  max-height: 220px;
  overflow: auto;
}

.brandMark {
  margin-bottom: 0;
}

header + .panel {
  margin-top: 0;
}

/* ========== responsive niceties ========== */
@media (min-width: 1280px) {
  .wrap {
    max-width: 1200px;
  }

  #url {
    width: min(760px, 100%);
  }

  .thumbWrap {
    width: clamp(320px, 40vw, 360px);
  }
}

@media (max-width: 960px) {
  .wrap {
    padding: 0 clamp(16px, 6vw, 28px);
  }
}

@media (max-width: 768px) {
  .list {
    min-width: min(420px, 100%);
  }
}

@media (max-width: 640px) {
  body {
    display: block;
    min-height: 100vh;
    margin: 0;
  }

  .wrap {
    grid-row: auto;
    margin: 12px auto 28px;
    padding: 0 clamp(14px, 6vw, 28px);
    padding-bottom: clamp(104px, 18vh, 176px);
  }

  .themeToggle {
    width: 40px;
    height: 40px;
    margin-bottom: 12px;
  }

  .thumbWrap {
    width: min(100%, 420px);
  }

  .foot {
    flex-wrap: wrap;
    justify-content: flex-start;
    align-items: flex-start;
    gap: 8px;
  }

  .foot__made {
    width: auto;
    text-align: left;
  }
}

@media (max-width: 640px) {
  .row.actions {
    grid-template-columns: repeat(2, max-content);
    grid-template-areas:
      "add add"
      "mp3 wav";
    row-gap: 12px;
  }

  .row.actions .or {
    display: none;
  }
}

@media (max-width: 420px) {
  .row.actions {
    grid-template-columns: max-content;
    grid-template-areas:
      "add"
      "mp3"
      "wav";
  }
}

@media (max-width: 560px) {
  .list thead th,
  .list tbody td {
    padding: 8px 6px;
  }

  .colIndex {
    width: 46px;
  }

  .colDur {
    width: 76px;
  }

  .colAct {
    width: 150px;
  }
}

@media (max-width: 440px) {
  .panel {
    padding: max(16px, var(--panel-pad) - 4px);
  }

  .row.actions {
    gap: 12px;
  }

  .thumbWrap {
    width: min(100%, 360px);
  }

  .listActions {
    width: 100%;
    align-items: center;
  }
}

@media (max-width: 480px) {
  .tableScroll {
    margin: 0 calc(var(--panel-pad) * -1);
    padding: 0 var(--panel-pad) 6px;
  }
}

.foot {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 12px;
  margin-top: 24px;
  width: 100%;
}

.foot__made {
  flex: none;
  text-align: left;
}

@media (min-width: 768px) {
  .themeToggle {
    position: fixed;
    top: clamp(16px, 4vh, 28px);
    left: clamp(16px, 4vw, 32px);
    z-index: 20;
    margin: 0;
  }

  .foot {
    flex-direction: column;
    align-items: flex-start;
    align-self: flex-start;
    width: auto;
    gap: 6px;
  }

  .disclaimerLink {
    left: clamp(16px, 4vw, 32px);
    right: auto;
    bottom: clamp(16px, 4vh, 32px);
  }
}

